<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>CrepeCake: Focus Edition</title>
    <style>
        /*
        [ê³µëª…ë¬¸: ê¾¸ë¯¸ê¸° ì„¤ëª…ì„œ (CSS)]
        ì´ê³³ì€ ì˜·ê³¼ í™”ì¥ì…ë‹ˆë‹¤. 
        í™”ë©´ì˜ ìƒ‰ê¹”, í¬ê¸°, ë°°ì¹˜ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.
        */
        :root {
            --bg-color: #fff0f5; /* Lavender Blush */
            --accent-color: #ff6b6b;
            --text-color: #333;
            --header-bg: #ffb7b2;
            --dock-bg: #fff;
        }
        body {
            margin: 0;
            padding: 0;
            font-family: 'Consolas', 'Malgun Gothic', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* Left: Explorer (Collapsed by default concept) */
        #explorer {
            width: 200px;
            background: white;
            border-right: 1px solid #ffcccc;
            display: flex;
            flex-direction: column;
            padding: 10px;
        }

        /* Center: Main Area */
        #main-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            overflow-y: auto;
            position: relative;
        }

        /* Accordion Layers */
        .layer-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 60px; /* Space for dock */
        }
        .layer {
            background: white;
            border: 1px solid #ffcccc;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .layer.active {
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.2);
            border-color: var(--accent-color);
        }
        .layer-header {
            padding: 15px;
            background: linear-gradient(to right, #fff0f5, white);
            cursor: pointer;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .layer-header:hover {
            background: #ffe6e6;
        }
        .layer-content {
            padding: 0;
            height: 0;
            overflow: hidden;
            opacity: 0;
            transition: all 0.3s ease;
            background: white;
        }
        .layer.active .layer-content {
            padding: 20px;
            height: 300px; /* Fixed height for focus, or auto */
            opacity: 1;
            overflow-y: auto;
        }
        textarea {
            width: 100%;
            height: 100%;
            border: none;
            resize: none;
            outline: none;
            font-family: inherit;
            font-size: 14px;
        }

        /* Right/Bottom: Dock */
        #dock-bar {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: flex;
            gap: 15px;
            z-index: 1000;
        }
        .dock-item {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s;
            font-size: 20px;
        }
        .dock-item:hover {
            transform: translateY(-5px) scale(1.1);
            background: var(--accent-color);
            color: white;
        }

        /* Popups (Stickers) */
        .popup {
            position: absolute;
            bottom: 80px;
            right: 20px;
            width: 250px;
            background: #fff9c4;
            border: 1px solid #fbc02d;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: none;
            animation: popUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popUp {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .popup-header {
            font-weight: bold;
            margin-bottom: 10px;
            color: #f57f17;
            display: flex;
            justify-content: space-between;
        }

        /* Mode Switch */
        .mode-switch {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            background: #ddd;
            color: #666;
        }
        .btn.active {
            background: var(--accent-color);
            color: white;
        }

    </style>
</head>
<body>
    <!-- 
    [ê³µëª…ë¬¸: ë¼ˆëŒ€ ì„¤ëª…ì„œ (HTML)]
    ì´ê³³ì€ ëª¸ì²´ì…ë‹ˆë‹¤. í™”ë©´ì— ë†“ì¼ ë¬¼ê±´(ë²„íŠ¼, ìƒì, ê¸€ì)ë“¤ì„ ë°°ì¹˜í•©ë‹ˆë‹¤.
    -->

    <div id="explorer">
        <!-- 
        [ì™¼ìª½ ì„œëì¥ (Explorer)]
        <div>: êµ¬ì—­ì„ ë‚˜ëˆ„ëŠ” íˆ¬ëª…í•œ ìƒìì…ë‹ˆë‹¤. id="explorer"ë¡œ ì´ë¦„ì„ ë¶™ì˜€ìŠµë‹ˆë‹¤.
        â— [ë‚´ìš©ë¬¼]: íŒŒì¼ ì´ë¦„ë“¤ (í…ìŠ¤íŠ¸)
        â— [í™”ë©´]: CSSì—ì„œ ì´ ì´ë¦„ì„ ê°€ì§„ ìƒìëŠ” ì™¼ìª½ì— ê³ ì •ë˜ë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.
        -->
        <div style="font-weight:bold; margin-bottom:10px; color:var(--accent-color);">ğŸ“‚ Explorer</div>
        <div style="font-size:0.9em; color:#666;">
            ğŸ“„ 2025-12-08_chat_log.md<br>
            ğŸ“„ main_logic.py<br>
            ğŸ“„ story_draft.txt
        </div>
    </div>

    <div id="main-area">
        <!-- 
        [ë©”ì¸ ì‘ì—…ëŒ€ (Main Area)]
        ì´ê³³ì€ ì‚¬ìš©ìê°€ ì‹¤ì œë¡œ ê¸€ì„ ì“°ê³  ì‘ì—…ì„ í•˜ëŠ” ë„“ì€ ê³µê°„ì…ë‹ˆë‹¤.
        -->
        <div class="mode-switch">
            <!-- 
            <button>: í´ë¦­í•  ìˆ˜ ìˆëŠ” ë²„íŠ¼ì„ ë§Œë“­ë‹ˆë‹¤.
            onclick="...": "í´ë¦­í•˜ë©´ ë”°ì˜´í‘œ ì•ˆì˜ ëª…ë ¹(í•¨ìˆ˜)ì„ ì‹¤í–‰í•´ë¼"ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤.
            -->
            <button class="btn active" onclick="toggleMode('logic')">ğŸ“ Logic Mode</button>
            <button class="btn" onclick="toggleMode('narrative')">ğŸ¨ Narrative Mode</button>
        </div>

        <div class="layer-container">
            <!-- 
            [ê²¹ê²¹ì´ ìŒ“ì¸ ìƒìë“¤ (Layer Stack)]
            class="layer": ì´ ìƒìë“¤ì€ ëª¨ë‘ ë˜‘ê°™ì€ ëª¨ì–‘(layer ìŠ¤íƒ€ì¼)ì„ ê°€ì§‘ë‹ˆë‹¤.
            -->
            <!-- Layer 1 -->
            <div class="layer" id="l1">
                <div class="layer-header" onclick="toggleLayer('l1')">
                    <span>1. Concept (Prompt)</span>
                    <span class="status">âœ¨</span>
                </div>
                <div class="layer-content">
                    <textarea placeholder="Write your core concept here..."></textarea>
                </div>
            </div>

            <!-- Layer 2 -->
            <div class="layer" id="l2">
                <div class="layer-header" onclick="toggleLayer('l2')">
                    <span>2. Structure (Logic/Arc)</span>
                    <span class="status">ğŸ”’</span>
                </div>
                <div class="layer-content">
                    <textarea placeholder="Define the structure..."></textarea>
                </div>
            </div>

            <!-- Layer 3 (Active by default) -->
            <div class="layer active" id="l3">
                <div class="layer-header" onclick="toggleLayer('l3')">
                    <span>3. Code / Story (Main Editor)</span>
                    <span class="status">âœï¸ Editing...</span>
                </div>
                <div class="layer-content">
                    <textarea style="font-family: monospace;">
def hello_world():
    print("Hello, Gongmyung!")
    # This is the main focus area.
    # Other layers are collapsed to reduce noise.
                    </textarea>
                </div>
            </div>

            <!-- Layer 6 -->
            <div class="layer" id="l6">
                <div class="layer-header" onclick="toggleLayer('l6')">
                    <span>6. Gongmyung (Resonance)</span>
                    <span class="status">ğŸ”®</span>
                </div>
                <div class="layer-content">
                    <textarea placeholder="System resonance analysis..."></textarea>
                </div>
            </div>
        </div>
    </div>

    <!-- Dock Bar -->
    <div id="dock-bar">
        <div class="dock-item" onclick="togglePopup('memo')" title="Memo">ğŸ“</div>
        <div class="dock-item" onclick="togglePopup('music')" title="Music">ğŸµ</div>
        <div class="dock-item" onclick="togglePopup('terminal')" title="Terminal">ğŸ’»</div>
    </div>

    <!-- Popups -->
    <div id="popup-memo" class="popup">
        <div class="popup-header">Memo <span onclick="togglePopup('memo')" style="cursor:pointer">x</span></div>
        <textarea style="height:100px; background:transparent;">Don't forget to check the 8th dimension logic.</textarea>
    </div>

    <div id="popup-music" class="popup" style="background:#e1bee7; border-color:#8e24aa;">
        <div class="popup-header" style="color:#4a148c;">Music <span onclick="togglePopup('music')" style="cursor:pointer">x</span></div>
        <div>Now Playing: Lo-Fi Beats ğŸ§</div>
        <div style="margin-top:10px; text-align:center;">â®ï¸ â¯ï¸ â­ï¸</div>
    </div>

    <!-- ê³µëª… ì¶”ì ì (ë””ë²„ê¹… ë„êµ¬) ì—°ê²° -->
    <script src="Gongmyung_Tracer.js"></script>
    <script>
        // [ì•ˆì „ ì¥ì¹˜] ë§Œì•½ ì¶”ì ì íŒŒì¼(Gongmyung_Tracer.js)ì„ ëª» ì°¾ìœ¼ë©´, 
        // ì—ëŸ¬ê°€ ë‚˜ì§€ ì•Šê²Œ 'ê°€ì§œ ì¶”ì ì'ë¥¼ ë§Œë“­ë‹ˆë‹¤.
        if (!window.gm) {
            console.warn("ê³µëª… ì¶”ì ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ ëª¨ë“œë¡œ ë™ì‘í•©ë‹ˆë‹¤.");
            window.gm = {
                input: () => {},
                logic: () => {},
                action: () => {}
            };
        }
    </script>

    <script>
        /* 
        [ê³µëª…ë¬¸: ì½”ë“œ í•´ì„¤ì„œ]
        ì½”ë“œê°€ ë‚¯ì„  ë¶„ë“¤ì„ ìœ„í•´, ì½”ë“œ ë°”ë¡œ ì•„ë˜ì— ì„¤ëª…ì„ ë‹¬ì•˜ìŠµë‹ˆë‹¤.
        */

        function toggleLayer(id) {
            /*
            [ì½”ë“œ] function toggleLayer(id)
            [ê¸°í˜¸] â— (í–‰ë™ ì •ì˜ ë° ì…ë ¥)
            [í•´ì„¤] 
            - function: "ê¸°ëŠ¥ì„ ë§Œë“¤ê² ë‹¤"ëŠ” ëœ»ì…ë‹ˆë‹¤.
            - toggleLayer: ê¸°ëŠ¥ì˜ ì´ë¦„ì…ë‹ˆë‹¤. (ìƒì ì—´ê³  ë‹«ê¸°)
            - (id): ì´ ê¸°ëŠ¥ì„ ì“¸ ë•Œ í•„ìš”í•œ ì¬ë£Œì…ë‹ˆë‹¤. (ëª‡ ë²ˆ ìƒìì¸ì§€)
            */

            // [Debug] ì¶”ì  ì‹œì‘
            gm.input("Layer ID ìˆ˜ì‹ ", id);

            document.querySelectorAll('.layer').forEach(l => {
                /*
                [ì½”ë“œ] document.querySelectorAll('.layer').forEach(...)
                [ê¸°í˜¸] â—‹ (ì „ì²´ íƒìƒ‰)
                [í•´ì„¤]
                - document: ì´ ë¬¸ì„œ ì „ì²´ì—ì„œ
                - querySelectorAll: '.layer'ë¼ëŠ” ì´ë¦„í‘œë¥¼ ê°€ì§„ ìƒìë¥¼ ëª¨ë‘ ì°¾ì•„ì„œ
                - forEach: í•˜ë‚˜ì”© êº¼ë‚´ì„œ ê²€ì‚¬í•©ë‹ˆë‹¤.
                */
                
                gm.logic(`ID ë¹„êµ (${l.id} == ${id})`, l.id === id);
                
                if (l.id === id) {
                    /*
                    [ì½”ë“œ] if (l.id === id)
                    [ê¸°í˜¸] â—‹ (ì¡°ê±´ íŒë‹¨)
                    [í•´ì„¤] "ì§€ê¸ˆ ê²€ì‚¬í•˜ëŠ” ìƒìì˜ ë²ˆí˜¸(l.id)ê°€ ì…ë ¥ë°›ì€ ë²ˆí˜¸(id)ì™€ ê°™ì€ê°€?" í™•ì¸í•©ë‹ˆë‹¤.
                    */

                    l.classList.toggle('active');
                    /*
                    [ì½”ë“œ] l.classList.toggle('active')
                    [ê¸°í˜¸] â— (í–‰ë™/ê²°ê³¼)
                    [í•´ì„¤]
                    - classList: ìƒìì˜ ìŠ¤íƒ€ì¼ ëª©ë¡ì—ì„œ
                    - toggle: 'active'ê°€ ìˆìœ¼ë©´ ë„ê³ , ì—†ìœ¼ë©´ ì¼­ë‹ˆë‹¤. (ìƒì ì—´ê¸°/ë‹«ê¸°)
                    */
                    gm.action("ìƒì ì—´ê¸°/ë‹«ê¸°", l);

                } else {
                    l.classList.remove('active'); 
                    /*
                    [ì½”ë“œ] l.classList.remove('active')
                    [ê¸°í˜¸] â— (í–‰ë™/ê²°ê³¼)
                    [í•´ì„¤] ë²ˆí˜¸ê°€ ë‹¤ë¥´ë©´ ë¬´ì¡°ê±´ 'active'ë¥¼ ì§€ì›Œì„œ ìƒìë¥¼ ë‹«ìŠµë‹ˆë‹¤.
                    */
                }
            });
        }

        function togglePopup(type) {
            /*
            [ì½”ë“œ] function togglePopup(type)
            [ê¸°í˜¸] â— (í–‰ë™ ì •ì˜)
            [í•´ì„¤] 'togglePopup'ì´ë¼ëŠ” ê¸°ëŠ¥ì„ ë§Œë“­ë‹ˆë‹¤. 'type'(íŒì—… ì¢…ë¥˜)ì„ ì¬ë£Œë¡œ ë°›ìŠµë‹ˆë‹¤.
            */

            const el = document.getElementById('popup-' + type);
            /*
            [ì½”ë“œ] const el = document.getElementById(...)
            [ê¸°í˜¸] â—‹ (ëŒ€ìƒ ì°¾ê¸°)
            [í•´ì„¤]
            - const el: 'el'ì´ë¼ëŠ” ë³„ëª…ì„ ë¶™ì—¬ì„œ ê¸°ì–µí•´ë‘¡ë‹ˆë‹¤.
            - getElementById: IDê°€ 'popup-ì¢…ë¥˜'ì¸ ìš”ì†Œë¥¼ ì°¾ì•„ì˜µë‹ˆë‹¤.
            */
            
            if (el) {
                /*
                [ì½”ë“œ] if (el)
                [ê¸°í˜¸] â—‹ (ì•ˆì „ ì¥ì¹˜)
                [í•´ì„¤] "ì°¾ìœ¼ë ¤ëŠ” íŒì—… ìƒìê°€ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ”ê°€?" í™•ì¸í•©ë‹ˆë‹¤.
                */

                el.style.display = el.style.display === 'block' ? 'none' : 'block';
                /*
                [ì½”ë“œ] el.style.display = ...
                [ê¸°í˜¸] â— (í–‰ë™/ê²°ê³¼)
                [í•´ì„¤] í˜„ì¬ ë³´ì´ë©´(block) ìˆ¨ê¸°ê³ (none), ìˆ¨ê²¨ì ¸ ìˆìœ¼ë©´ ë³´ì´ê²Œ í•©ë‹ˆë‹¤.
                */
            }
        }

        function toggleMode(mode) {
            /*
            [ì½”ë“œ] function toggleMode(mode)
            [ê¸°í˜¸] â— (í–‰ë™ ì •ì˜)
            [í•´ì„¤] 'toggleMode'ë¼ëŠ” ê¸°ëŠ¥ì„ ë§Œë“­ë‹ˆë‹¤. (ë¡œì§ ëª¨ë“œ / ì†Œì„¤ ëª¨ë“œ ì „í™˜)
            */

            document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
            /*
            [ì½”ë“œ] document.querySelectorAll('.btn')...remove('active')
            [ê¸°í˜¸] â— (ì´ˆê¸°í™” í–‰ë™)
            [í•´ì„¤] ëª¨ë“  ë²„íŠ¼(.btn)ì„ ì°¾ì•„ì„œ, ì¼œì ¸ ìˆëŠ” ë¶ˆ(active)ì„ ë‹¤ ë•ë‹ˆë‹¤.
            */
            
            event.target.classList.add('active');
            /*
            [ì½”ë“œ] event.target.classList.add('active')
            [ê¸°í˜¸] â— (ì„ íƒ í–‰ë™)
            [í•´ì„¤] ë°©ê¸ˆ í´ë¦­í•œ ê·¸ ë²„íŠ¼(event.target)ì—ë§Œ ë¶ˆ(active)ì„ ì¼­ë‹ˆë‹¤.
            */
        }
    </script>
</body>
</html>
